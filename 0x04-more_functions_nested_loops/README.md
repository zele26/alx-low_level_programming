more functions with nested loops
